{% load static %}
<span id="subtitle" hx-swap-oob="true">OVERVIEW</span>
<section id="overview-section" class="overview-section"
    hx-trigger="load">
    {% include 'partials/hx-indicator.html' %}
    <!-- Artículo para los botones -->
    <article id="toggle-buttons-container">
        <div id="toggle-buttons" class="button-group">
            <div id="toggle-buttons-timeframe" class="button-cluster">
                <button class="button {% if metadata.timeframe == '5s' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe=5s&metric={{ metadata.metric }}&room={{ room|yesno:'true,false' }}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner"><small>5"</small></button>
                <button class="button {% if metadata.timeframe == '1T' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe=1T&metric={{ metadata.metric }}&room={{ room|yesno:'true,false' }}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">1'</button>
                <button class="button {% if metadata.timeframe == '30T' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe=30T&metric={{ metadata.metric }}&room={{ room|yesno:'true,false' }}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">30'</button>
                <button class="button {% if metadata.timeframe == '1h' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe=1h&metric={{ metadata.metric }}&room={{ room|yesno:'true,false' }}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">1h</button>
                <button class="button {% if metadata.timeframe == '4h' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe=4h&metric={{ metadata.metric }}&room={{ room|yesno:'true,false' }}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">4h</button>
                <button class="button {% if metadata.timeframe == '1D' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe=1D&metric={{ metadata.metric }}&room={{ room|yesno:'true,false' }}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">1d</button>
            </div>
            <div id="toggle-buttons-metric" class="button-cluster">
                <button class="button metric {% if metadata.metric == 't' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?metric=t"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">Temp</button>
                <button class="button metric {% if metadata.metric == 'h' %}active{% endif %}"
                        hx-get="{% url 'overview' %}?metric=h"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">Hum</button>
            </div>
            <div class="button-cluster">
                <button class="button {% if room %}active{% endif %}"
                        hx-get="{% url 'overview' %}?timeframe={{ metadata.timeframe }}&metric={{ metadata.metric }}&room={% if room %}false{% else %}true{% endif %}"
                        hx-target="#overview-section"
                        hx-swap="outerHTML"
                        hx-indicator="#loading-spinner">Salas</button>
            </div>
        </div>
    </article>

    <!-- Artículo para el gráfico -->
    <article id="chart-content">
        <div class="chart-container" id="chart">
            <div class="chart-placeholder htmx-indicator">
                <div class="placeholder-text">Cargando datos...</div>
                <div class="placeholder-animation"></div>
            </div>
            {{ chart_html|safe }}
        </div>
    </article>
    <!-- Artículo para debug -->
    <article id="debug-info">
        <div class="debug-section">
            <h3>Metadata</h3>
            <pre class="debug-pre">
<strong>Período actual</strong>: {{ metadata.start_pretty }} → {{ metadata.end_pretty }}
<strong>Registros</strong>: {{ metadata.record_count }}
<strong>Puntos graficados</strong>: {{ plotted_points }}
<strong>Sensores</strong>: {{ metadata.sensor_ids|join:", " }}
<strong>Timeframe</strong>: {{ metadata.timeframe }}
<strong>Ventana</strong>: {{ metadata.window_minutes }} min
<strong>Métrica</strong>: {{ metadata.metric }}
<strong>Uso Servidor</strong>: {{ metadata.query_duration_s }} s
<strong>Tiempo Total</strong>: <span id="total-time"></span></pre>
        </div>

    </article>
</section>