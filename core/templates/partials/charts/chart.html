{% load static %}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/chart.css' %}">
{% endblock %}

{% block header-navbar %}
<button hx-get="javascript:history.back()" class="button">
  <img src="{% static 'icons/arrow-back.svg' %}" alt="Back" style="vertical-align: middle;">
  Back
</button>
{% endblock %}

{% block content %}
<div id="chart-container">
    {% if error %}
        <div class="alert alert-danger">
            <h4 class="alert-heading">Error</h4>
            <p>{{ error }}</p>
            <hr>
            <p class="mb-0">Por favor, verifique que el servidor de la API esté funcionando y vuelva a intentar.</p>
        </div>
    {% else %}
        {{ chart_html|safe }}
    {% endif %}
</div>
<div id="toggle-buttons" class="button-group">
    <div id="toggle-buttons-timeframe">
    <strong>Resumen de Datos:</strong>
    <strong>Total registros:</strong> {{ debug.num_points }}
    <strong>Puntos graficados:</strong> {{ debug.plotted_points }}
    <strong>Sensores:</strong> {{ debug.sensors|join:", " }}
    <strong>Primer registro:</strong> {{ debug.first_record.timestamp }} ({{ debug.first_record.sensor }}: {{ debug.first_record.value }})
    <strong>Último registro:</strong> {{ debug.last_record.timestamp }} ({{ debug.last_record.sensor }}: {{ debug.last_record.value }})
    <strong>Primer registro online:</strong> {{ debug.first_record_online.timestamp }} ({{ debug.first_record_online.sensor }}: {{ debug.first_record_online.value }})
    <strong>Segundo registro online:</strong> {{ debug.second_record_online.timestamp }} ({{ debug.second_record_online.sensor }}: {{ debug.second_record_online.value }})
    <strong>Intervalo:</strong> {{ selected_timeframe }}
</pre>
<hr/>
{% endblock %}

{% block scripts %}
    <script>
        var metric = '{{ metric }}';
        var selectedTimeframe = '{{ selected_timeframe }}';
    </script>
    <script src="{% static 'js/chart.js' %}"></script>
{% endblock %}
